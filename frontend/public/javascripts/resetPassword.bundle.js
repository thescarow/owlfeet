(()=>{const e=document.getElementById("forgotPasswordForm"),t=document.getElementById("otpNotification"),s=document.getElementById("mobileNotification"),o=document.getElementById("forgotPasswordFormPage1"),r=document.getElementById("forgotPasswordFormPage2"),n=document.getElementById("forgotPasswordFormPage3"),a=document.getElementById("forgotPasswordProgressInfoStep"),l=document.getElementById("forgotPasswordProgressInfoStepInfo"),d=document.getElementById("forgotPasswordProgressBarhighlighter"),c=document.getElementById("mobileData"),i=document.getElementById("mobileNumber"),u=document.getElementById("sendOtp"),m=/^[5-9][0-9]{9}$/;u.addEventListener("click",(()=>{m.test(i.value)?fetch("/user-auth/send-reset-password-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile:i.value})}).then((e=>{if(e.ok)return e.json();throw new Error("Server Error,Please try again")})).then((n=>{n.isSuccess?(o.style.left="-150%",r.style.left="0%",e.scrollTop=0,c.textContent=i.value,d.style.width="66%",l.textContent="OTP",a.textContent="STEP: 2 OF 3",t.textContent="Otp send Successfully,Please check your inbox",t.classList.add("show","success"),setTimeout((()=>{t.classList.remove("show","success")}),5e3)):(s.textContent=n.error,s.classList.add("show","error"),setTimeout((()=>{s.classList.remove("show","error")}),5e3))})).catch((e=>{s.textContent="Server Error",s.classList.add("show","error"),setTimeout((()=>{s.classList.remove("show","error")}),5e3)})):(s.textContent="Invalid Mobile Number, Please Change It",s.classList.add("show"),setTimeout((()=>{s.classList.remove("show")}),5e3))}));const g=document.getElementById("backToMobilePage"),h=document.getElementById("getNewPasswordForm"),p=document.querySelectorAll("#otp input");function w(e){const s=e.clipboardData.getData("text").split("");s.length==p.length?p.forEach(((e,t)=>e.value=s[t])):(t.textContent="You have copied incomplete otp,please go and copy again",t.classList.add("show"),setTimeout((()=>{t.classList.remove("show")}),5e3))}function y(e){const t=e.target;let s=t.value;t.value="",t.value=s?s[0]:"";let o=t.dataset.index;s.length>0&&o<p.length-1&&t.nextElementSibling.focus(),"Backspace"==e.key&&o>0&&t.previousElementSibling.focus()}p.forEach(((e,t)=>{e.dataset.index=t,e.addEventListener("paste",w),e.addEventListener("keyup",y)})),h.addEventListener("click",(()=>{let s="";if(p.forEach((e=>{s+=e.value})),console.log(s),10==i.value.length&&6==s.length){let o={otp:s,mobile:i.value};fetch("/user-auth/check-mobile-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then((e=>{if(e.ok)return e.json();throw new Error("Server Error")})).then((s=>{s.isSuccess?(r.style.left="-150%",n.style.left="0%",e.scrollTop=0,d.style.width="100%",l.textContent="Set New Password",a.textContent="STEP: 3 OF 3"):(t.textContent=s.error,t.classList.add("show","error"),setTimeout((()=>{t.classList.remove("show","error")}),5e3))})).catch((e=>{t.textContent="Server Error",t.classList.add("show","error"),setTimeout((()=>{t.classList.remove("show","error")}),5e3)}))}else t.textContent="Error: Please type correct otp",t.classList.add("show","error"),setTimeout((()=>{t.classList.remove("show","error")}),5e3)})),g.addEventListener("click",(()=>{r.style.left="150%",o.style.left="0%",e.scrollTop=0,d.style.width="33%",l.textContent="Your Mobile Number",a.textContent="STEP: 1 OF 3"}));const E=document.getElementById("password"),v=[...document.querySelectorAll("#passwordStrength div")],f=document.getElementsByClassName("password-strength-text")[0],L=document.getElementById("passwordRule8"),x=document.getElementById("passwordRuleNumber"),C=document.getElementById("passwordRuleUpper"),P=document.getElementById("passwordRuleSpecial");let S,T=new RegExp("(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,})"),b=new RegExp("((?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{6,}))|((?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])(?=.{8,}))|((?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])(?=.{8,}))|((?=.*[a-z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,}))"),I=new RegExp("(?=.{8,})"),B=new RegExp("\\d"),k=new RegExp("[A-Z]"),N=new RegExp("[^A-Za-z0-9]");E.addEventListener("input",(()=>{clearTimeout(S),S=setTimeout((()=>function(e){if(L.classList.toggle("true",I.test(e)),x.classList.toggle("true",B.test(e)),C.classList.toggle("true",k.test(e)),P.classList.toggle("true",N.test(e)),T.test(e)){for(let e=0;e<v.length;e++)v[e].classList.remove("weak","medium"),v[e].classList.add("strong");f.textContent="Strong"}else if(b.test(e)){for(let e=0;e<v.length;e++)v[e].classList.remove("weak","medium","strong");v[0].classList.add("medium"),v[1].classList.add("medium"),f.textContent="Medium"}else{for(let e=0;e<v.length;e++)v[e].classList.remove("weak","medium","strong");v[0].classList.add("weak"),f.textContent="Low"}}(E.value)),500),0==E.value.length&&(v[0].style.backgroundColor="transparent",v[1].style.backgroundColor="transparent",v[2].style.backgroundColor="transparent",f.textContent="None")})),E.addEventListener("keyup",(e=>{E.value=E.value.replace(/\s/g,"")}));const A=document.getElementById("confirmPasswordCheck"),O=document.getElementById("confirmPassword");let z;O.addEventListener("input",(()=>{clearTimeout(z),z=setTimeout((()=>{O.value==E.value?A.textContent="match":A.textContent="no match"}),500),0==O.value.length&&(A.textContent="no match")})),O.addEventListener("keyup",(e=>{O.value=O.value.replace(/\s/g,"")}));const Z=[...document.getElementsByClassName("password-show")];Z.forEach((e=>{e.addEventListener("click",(()=>{Z.forEach((e=>{e.classList.toggle("show")})),"password"==E.getAttribute("type")?(E.type="text",O.type="text"):(E.type="password",O.type="password")}))}));const R=document.getElementById("submitForgotPassword"),F=document.getElementById("submitNotification");R.addEventListener("click",(()=>{if(E.value==O.value){let e={mobile:i.value,password:E.value};console.log(e),fetch("/user-auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e.ok)return e.json();throw new Error("Server Error")})).then((e=>{e.isSuccess?(F.textContent="Password Changed Successfully",F.classList.add("show","success"),setTimeout((()=>{F.classList.remove("show","success"),location.replace("/user-auth/login")}),2e3)):(F.textContent=e.error,F.classList.add("show","error"),setTimeout((()=>{F.classList.remove("show","error")}),5e3))})).catch((e=>{F.textContent="Server Error",F.classList.add("show","error"),setTimeout((()=>{F.classList.remove("show","error")}),5e3)}))}}))})();